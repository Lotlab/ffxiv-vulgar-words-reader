# 文件格式

所有数据都是小端数据。

## 未知数据

0x0000-0x8125

未知用途

## 字典表

0x8126-0x8723

未知用途

## 偏移量表

0x8724-0x874F

存储着后面的各表的偏移量与长度。

| 位置 | 起始节点索引表 | 中间节点索引表 | 单字表 | 多字表 | 树结构表 |
| --- | ------------ | ----------- | ----- | ----- | ------- |
|偏移量|     0x8724   |   0x8728    | 0x872c | 0x8730 | 0x8734 | 
| 长度 |    0x8738    |   0x873C    | 0x8740 | 0x8744 | 0x8748 |

这里的偏移量是相对于下面的字符映射表的末尾而言的，即实际偏移量要在上表的基础上加上 0x8950

## 字符映射表

0x8750 - 0x894F

以 uint16 数组的形式存储起始节点索引中的字符区块映射关系。

对于任意一个字符，假设其 Unicode 为 0x3456，则其在起始节点索引表中的索引值为：

``` C
index = (map[0x34] << 8) + 0x56;
```

## 起始节点索引表

长度与偏移量参见偏移量表。

以 uint16 数组的形式存储对应字符的节点信息的索引。

## 中间节点索引表

长度与偏移量参见偏移量表。

以 uint16 数组的形式存储节点信息的索引。

## 单字表

长度与偏移量参见偏移量表。

以 uint16 数组的形式存储单个字符。

## 多字表

长度与偏移量参见偏移量表。

以 uint16 数组的形式存储。

表内存储着长度大于2的字符串，所有的字符串后面均跟随着0，作为字符串结束的标志。

## 树结构信息表

长度与偏移量参见偏移量表。

存储着树的结构信息，数据结构如下：

```C
struct {
    uint16_t flag;
    uint16_t sibling_count;
    uint16_t child_index;
    uint16_t str_offset;
} items[];
```
具体解释如下：

- flag: 取值为 0 或 1，表示应当从单字表还是多字表中取字符；
- sibling_count: 树的当前节点有多少兄弟节点，此节点数目包括本身；
- child_index: 子节点在中间节点索引表中的索引；
- str_offset: 当前节点的字符串在字表中的偏移量

# 读取步骤

1. 读取偏移量表，得到剩下表的偏移量和长度
2. 读取字符映射表，得到字符的映射
3. 根据查询的字符，根据字符映射得到偏移量
4. 根据这一偏移量，在起始节点索引表中查询节点信息索引
  - 若节点信息为0，则说明字符不存在
  - 若节点信息不为0，则继续查找
5. 根据节点信息索引，在树结构信息表中查找对应结构信息
  1. 根据 flag 和 str_offset，读取此节点的字符串
  2. 若 child_index 不为 0，则根据中间节点索引表查找字节点
  3. 若 sibling_count 不为 1，则其兄弟节点的
    - 字符串为 str_offset + id
    - 子节点为 child_index + id
